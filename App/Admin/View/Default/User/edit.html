<extend name="Public:base"/>

<block name="main">
<div id="yzh-content" class="col-xs-12">
  <div class="table-header">
  <a href="{:U('User/index')}">管理员列表</a>
  <a href="{:U('User/add')}" >添加管理员</a>
  </div>

  <div class="box-body">
  <form id="myform" class="form-horizontal" action="{:U('User/update')}" method="post">
    <input type="hidden" name="question" value="{$vo.age}">
    <input type="hidden" name="answer" value="{$vo.address}">
    <input type="hidden" name="status" value="1" />
    <div class="form-group">
      <label class="col-sm-2 control-label">用户名</label>
      <div class="col-xs-4">
      <input type="text" class="form-control" name="username" value="{$vo.username}" >
      </div>
    </div>
    <div class="form-group">
      <label class="col-sm-2 control-label">密码</label>
      <div class="col-xs-4">
      <input type="password" id="password" name="pwd" class="form-control" />
      <em for="password" generated="true" class="info">不修改密码请留空。</em>
      </div>
    </div>
    <div class="form-group">
      <label class="col-sm-2 control-label">确认密码</label>
      <div class="col-xs-4">
        <input type="password" id="password" name="repwd" class="form-control" />
        <em for="password" generated="true" class="info">不修改密码请留空。</em>
      </div>
    </div>
    <div class="form-group">
      <label class="col-sm-2 control-label">邮箱</label>
      <div class="col-xs-4">
      <input type="text" class="form-control"  name="email" value="{$vo.email}" >
      </div>
    </div>
    <div class="form-group">
      <label class="col-sm-2 control-label">{:L('realname')}</label>
      <div class="col-xs-4">
      <input type="text" class="form-control"  name="realname" value="{$vo.realname}" >
      </div>
    </div>
    <div class="form-group">
      <label class="col-sm-2 control-label">所属角色</label>
      <div class="col-xs-4">
        <select name="groupid" class="form-control">
        <volist name="usergroup" id="r">
        <option {if $vo['groupid']==$r['id']}selected="selected"{/if} value="{$r['id']}">{$r['name']}</option>
        </volist>
        </select>
      </div>
    </div>
    <div class="form-actions">
      <div class="col-sm-offset-2">
        <input type="hidden" name="id" value="{$vo['id']}" />
        <input type="hidden" name="opwd" value="{$vo['password']}" />
        <input type="submit" value="确认" class="btn btn-sm btn-primary" >
        <input type="reset" value="重置" class="btn btn-sm btn-primary">
      </div>
    </div>
  </form>
</div>

<script type="text/javascript">
$(document).ready(function() {
  $('#myform').ajaxForm({
    success:  complete,  // post-submit callback
    dataType: 'json'
  });
});

function complete(data){
  if(data.status==1){
    $.scojs_message('修改成功', $.scojs_message.TYPE_OK);
    setTimeout(function(){
      window.location.href = '{:U("User/index")}';
    },1000);
  }else{
    $.scojs_message(data.info, $.scojs_message.TYPE_ERROR);
  }

}
</script>

</block>